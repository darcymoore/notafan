<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NotAFan â€” Instagram Audit</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;1,400;1,700&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg: #fdf8fc;
    --surface: #ffffff;
    --border: #ecd8ea;
    --border-light: #f6eef5;
    --accent: #c0608e;
    --accent2: #9b6bbf;
    --accent3: #6b8fd4;
    --accent4: #e0856a;
    --text: #251828;
    --muted: #a090aa;
    --soft: #f9f0f7;
    --green: #5a9e80;
    --red: #c06070;
    --rose: #f5d8ee;
    --lavender: #e4d8f5;
    --blue: #d2e0f8;
    --mint: #d2ede2;
    --peach: #fce4d8;
  }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-weight: 300;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Dreamy layered background */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background:
      radial-gradient(ellipse 80% 55% at 0% 0%, #f5d8ee70 0%, transparent 55%),
      radial-gradient(ellipse 60% 45% at 100% 100%, #d2e0f870 0%, transparent 55%),
      radial-gradient(ellipse 45% 35% at 70% 20%, #e4d8f540 0%, transparent 50%),
      radial-gradient(ellipse 35% 30% at 20% 80%, #d2ede240 0%, transparent 50%);
    pointer-events: none;
    z-index: 0;
  }

  .container {
    position: relative;
    z-index: 1;
    max-width: 820px;
    margin: 0 auto;
    padding: 4.5rem 2rem 6rem;
  }

  /* â”€â”€ Header â”€â”€ */
  header {
    text-align: center;
    margin-bottom: 4rem;
    animation: fadeUp 0.9s ease both;
  }

  .logo {
    font-family: 'Playfair Display', serif;
    font-size: clamp(3.2rem, 8vw, 5.5rem);
    font-weight: 700;
    font-style: italic;
    background: linear-gradient(125deg, #c85a8a 0%, #a05ead 35%, #6b8fd4 65%, #e0856a 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    letter-spacing: -0.01em;
    line-height: 1;
    margin-bottom: 1rem;
  }

  .logo-sub {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
  }

  .logo-line {
    height: 1px;
    width: 50px;
    background: linear-gradient(90deg, transparent, var(--border));
  }

  .logo-line.right {
    background: linear-gradient(90deg, var(--border), transparent);
  }

  .tagline {
    color: var(--muted);
    font-size: 0.68rem;
    letter-spacing: 0.22em;
    text-transform: uppercase;
    font-weight: 400;
  }

  /* â”€â”€ How-to card â”€â”€ */
  .how-to {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 24px;
    padding: 2rem 2.25rem;
    margin-bottom: 2rem;
    animation: fadeUp 0.9s 0.1s ease both;
    position: relative;
    overflow: hidden;
  }

  .how-to::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
    background: linear-gradient(90deg, #c85a8a, #a05ead, #6b8fd4, #e0856a);
    border-radius: 24px 24px 0 0;
  }

  .how-to-title {
    font-family: 'Playfair Display', serif;
    font-size: 0.78rem;
    font-weight: 700;
    letter-spacing: 0.16em;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 1.4rem;
    padding-top: 0.25rem;
  }

  .steps { display: flex; flex-direction: column; gap: 0.8rem; }

  .step {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    font-size: 0.81rem;
    color: var(--muted);
    line-height: 1.65;
  }

  .step-num {
    background: linear-gradient(135deg, var(--rose), var(--lavender));
    color: var(--accent2);
    font-family: 'Playfair Display', serif;
    font-weight: 700;
    font-size: 0.68rem;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    margin-top: 1px;
  }

  .step strong { color: var(--text); font-weight: 500; }
  .step code {
    background: var(--soft);
    padding: 1px 6px;
    border-radius: 5px;
    font-size: 0.77rem;
    color: var(--accent);
    font-family: monospace;
  }

  /* â”€â”€ Upload section â”€â”€ */
  .upload-section {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.25rem;
    margin-bottom: 1.25rem;
    animation: fadeUp 0.9s 0.2s ease both;
  }

  @media (max-width: 540px) { .upload-section { grid-template-columns: 1fr; } }

  .drop-zone {
    border: 1.5px dashed var(--border);
    border-radius: 22px;
    padding: 2.5rem 1.5rem 2rem;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    background: var(--surface);
    position: relative;
    overflow: hidden;
  }

  /* subtle inner glow per zone */
  .drop-zone.followers { background: linear-gradient(160deg, #fff 60%, #fdf2fa); }
  .drop-zone.following { background: linear-gradient(160deg, #fff 60%, #f2f5fd); }

  .drop-zone::after {
    content: '';
    position: absolute;
    inset: 0;
    opacity: 0;
    transition: opacity 0.3s;
    pointer-events: none;
    z-index: 0;
  }

  .drop-zone.followers::after { background: radial-gradient(ellipse at 50% 100%, #f5d8ee50, transparent 70%); }
  .drop-zone.following::after { background: radial-gradient(ellipse at 50% 100%, #d2e0f850, transparent 70%); }

  .drop-zone:hover, .drop-zone.dragover {
    border-color: var(--accent);
    border-style: solid;
    transform: translateY(-4px);
    box-shadow: 0 16px 48px rgba(192,96,142,0.13);
  }

  .drop-zone:hover::after, .drop-zone.dragover::after { opacity: 1; }

  .drop-zone.loaded {
    border-color: var(--green);
    border-style: solid;
    box-shadow: 0 4px 24px rgba(90,158,128,0.13);
  }

  .drop-zone input[type="file"] {
    position: absolute;
    inset: 0;
    opacity: 0;
    cursor: pointer;
    width: 100%;
    height: 100%;
    z-index: 10;
  }

  .drop-icon {
    font-size: 2rem;
    margin-bottom: 0.85rem;
    display: block;
    opacity: 0.45;
    position: relative;
    z-index: 1;
  }

  .drop-label {
    font-family: 'Playfair Display', serif;
    font-size: 1.55rem;
    font-weight: 700;
    font-style: italic;
    margin-bottom: 0.45rem;
    color: var(--text);
    position: relative;
    z-index: 1;
  }

  .drop-sub {
    font-size: 0.68rem;
    color: var(--muted);
    line-height: 1.75;
    letter-spacing: 0.04em;
    position: relative;
    z-index: 1;
  }

  .status-badge {
    display: inline-block;
    margin-top: 1rem;
    padding: 0.28rem 0.9rem;
    border-radius: 100px;
    font-size: 0.65rem;
    letter-spacing: 0.07em;
    background: var(--soft);
    color: var(--muted);
    transition: all 0.35s;
    font-weight: 400;
    position: relative;
    z-index: 1;
  }

  .status-badge.ok { background: var(--mint); color: var(--green); }

  /* â”€â”€ Compare button â”€â”€ */
  .compare-btn {
    display: block;
    width: 100%;
    padding: 1.05rem 1.5rem;
    border: 1.5px solid var(--border);
    border-radius: 16px;
    background: var(--surface);
    color: var(--muted);
    font-family: 'DM Sans', sans-serif;
    font-size: 0.72rem;
    font-weight: 400;
    letter-spacing: 0.24em;
    text-transform: uppercase;
    cursor: not-allowed;
    transition: all 0.3s ease;
    margin-bottom: 4rem;
    animation: fadeUp 0.9s 0.3s ease both;
  }

  .compare-btn.ready {
    border-color: transparent;
    background: linear-gradient(var(--surface), var(--surface)) padding-box,
                linear-gradient(110deg, #c85a8a, #a05ead, #6b8fd4) border-box;
    border: 1.5px solid transparent;
    color: var(--accent2);
    cursor: pointer;
    box-shadow: 0 4px 24px rgba(160,94,173,0.13);
  }

  .compare-btn.ready:hover {
    background: linear-gradient(110deg, #c85a8a, #a05ead, #6b8fd4);
    color: #fff;
    transform: translateY(-2px);
    box-shadow: 0 10px 36px rgba(160,94,173,0.28);
  }

  /* â”€â”€ Results â”€â”€ */
  #results { display: none; animation: fadeUp 0.6s ease both; }

  .results-title {
    font-family: 'Playfair Display', serif;
    font-size: 2rem;
    font-weight: 400;
    font-style: italic;
    text-align: center;
    color: var(--text);
    margin-bottom: 2rem;
    opacity: 0.85;
  }

  .stats-row {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
    margin-bottom: 2.5rem;
  }

  @media (max-width: 480px) { .stats-row { grid-template-columns: 1fr; } }

  .stat-card {
    border-radius: 20px;
    padding: 1.6rem 1rem 1.4rem;
    text-align: center;
    border: 1px solid transparent;
  }

  .stat-card.rose {
    background: linear-gradient(160deg, #fff 40%, #fdeef8);
    border-color: var(--rose);
  }
  .stat-card.blue {
    background: linear-gradient(160deg, #fff 40%, #edf2fd);
    border-color: var(--blue);
  }
  .stat-card.mint {
    background: linear-gradient(160deg, #fff 40%, #edf8f3);
    border-color: var(--mint);
  }

  .stat-num {
    font-family: 'Playfair Display', serif;
    font-size: 3.4rem;
    font-weight: 700;
    line-height: 1;
    margin-bottom: 0.45rem;
  }

  .stat-num.rose-text { color: var(--accent); }
  .stat-num.blue-text { color: var(--accent3); }
  .stat-num.green-text { color: var(--green); }

  .stat-label {
    font-size: 0.62rem;
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 0.13em;
    font-weight: 400;
  }

  /* â”€â”€ Tabs â”€â”€ */
  .tabs {
    display: flex;
    border-bottom: 1px solid var(--border);
    margin-bottom: 0;
    flex-wrap: wrap;
  }

  .tab {
    padding: 0.7rem 1.3rem;
    border: none;
    border-bottom: 2px solid transparent;
    background: none;
    color: var(--muted);
    font-family: 'DM Sans', sans-serif;
    font-size: 0.71rem;
    font-weight: 400;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    cursor: pointer;
    transition: all 0.2s;
    margin-bottom: -1px;
  }

  .tab:hover { color: var(--text); }
  .tab.active { color: var(--accent); border-bottom-color: var(--accent); font-weight: 500; }

  /* â”€â”€ Search â”€â”€ */
  .search-bar {
    width: 100%;
    padding: 0.85rem 1.2rem;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 14px;
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 0.82rem;
    font-weight: 300;
    margin-top: 1.4rem;
    margin-bottom: 1rem;
    outline: none;
    transition: border-color 0.2s, box-shadow 0.2s;
    letter-spacing: 0.02em;
  }

  .search-bar:focus {
    border-color: var(--accent2);
    box-shadow: 0 0 0 3px rgba(155,107,191,0.09);
  }

  .search-bar::placeholder { color: var(--muted); }

  /* â”€â”€ List â”€â”€ */
  .list-container {
    display: flex;
    flex-direction: column;
    gap: 0.4rem;
    max-height: 520px;
    overflow-y: auto;
    padding-right: 0.3rem;
  }

  .list-container::-webkit-scrollbar { width: 3px; }
  .list-container::-webkit-scrollbar-track { background: transparent; }
  .list-container::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }

  .user-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: var(--surface);
    border: 1px solid var(--border-light);
    border-radius: 13px;
    padding: 0.8rem 1.1rem;
    transition: border-color 0.2s, transform 0.15s, box-shadow 0.2s;
    animation: fadeUp 0.3s ease both;
  }

  .user-row:hover {
    border-color: var(--border);
    transform: translateX(5px);
    box-shadow: 0 3px 14px rgba(0,0,0,0.045);
  }

  .username {
    font-size: 0.84rem;
    color: var(--text);
    font-weight: 300;
    letter-spacing: 0.01em;
  }

  .ig-link {
    color: var(--accent2);
    text-decoration: none;
    font-size: 0.65rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    padding: 0.28rem 0.9rem;
    border: 1px solid var(--lavender);
    border-radius: 100px;
    transition: all 0.22s;
    white-space: nowrap;
    font-weight: 400;
  }

  .ig-link:hover {
    background: linear-gradient(110deg, #c85a8a, #9b6bbf);
    border-color: transparent;
    color: #fff;
  }

  .empty-state {
    text-align: center;
    padding: 3.5rem;
    color: var(--muted);
    font-family: 'Playfair Display', serif;
    font-style: italic;
    font-size: 1.05rem;
  }

  /* â”€â”€ Footer â”€â”€ */
  .privacy-note {
    text-align: center;
    font-size: 0.67rem;
    color: var(--muted);
    margin-top: 3.5rem;
    padding-top: 2rem;
    border-top: 1px solid var(--border);
    letter-spacing: 0.09em;
  }

  .privacy-note span { color: var(--green); }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(18px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  .panel { display: none; }
  .panel.active { display: block; }
</style>
</head>
<body>
<div class="container">

  <header>
    <div class="logo">NotAFan</div>
    <div class="logo-sub">
      <div class="logo-line"></div>
      <div class="tagline">Instagram Follower Audit Â· Private Â· No Login</div>
      <div class="logo-line right"></div>
    </div>
  </header>

  <div class="how-to">
    <div class="how-to-title">How to export your Instagram data</div>
    <div class="steps">
      <div class="step"><div class="step-num">1</div><span>On Instagram, go to your profile â†’ â˜° â†’ <strong>Settings</strong> â†’ <strong>Accounts Center</strong></span></div>
      <div class="step"><div class="step-num">2</div><span>In Accounts Center, tap <strong>Your information and permissions</strong></span></div>
      <div class="step"><div class="step-num">3</div><span>Tap <strong>Download your information</strong> â†’ <strong>Download or transfer information</strong></span></div>
      <div class="step"><div class="step-num">4</div><span>Select your Instagram account â†’ choose <strong>Some of your information</strong> â†’ select <strong>Followers and following</strong></span></div>
      <div class="step"><div class="step-num">5</div><span>Set the date range to <strong>All time</strong>, choose <strong>Download to device</strong>, set format to <strong>HTML</strong> or <strong>JSON</strong>, then submit â€” Instagram will email you a download link</span></div>
      <div class="step"><div class="step-num">6</div><span>Unzip the file â†’ open <code>followers_and_following/</code> â†’ upload all <code>followers_*.html</code> files and <code>following.html</code> below</span></div>
    </div>
  </div>

  <div class="upload-section">
    <div class="drop-zone followers" id="zone-followers">
      <input type="file" id="file-followers" accept=".html,.htm,.json" multiple>
      <span class="drop-icon">ðŸ‘¥</span>
      <div class="drop-label">Followers</div>
      <div class="drop-sub">Select all your followers files<br>Hold Ctrl / Cmd to pick multiple</div>
      <div class="status-badge" id="badge-followers">No file selected</div>
    </div>
    <div class="drop-zone following" id="zone-following">
      <input type="file" id="file-following" accept=".html,.htm,.json" multiple>
      <span class="drop-icon">âœ¦</span>
      <div class="drop-label">Following</div>
      <div class="drop-sub">Select your following file(s)<br>Usually just one file</div>
      <div class="status-badge" id="badge-following">No file selected</div>
    </div>
  </div>

  <button class="compare-btn" id="compare-btn" onclick="compare()">Compare</button>

  <div id="results">
    <div class="results-title">Your results</div>
    <div class="stats-row">
      <div class="stat-card rose">
        <div class="stat-num rose-text" id="stat-nonfollowers">â€”</div>
        <div class="stat-label">Not following back</div>
      </div>
      <div class="stat-card blue">
        <div class="stat-num blue-text" id="stat-notfollowing">â€”</div>
        <div class="stat-label">You don't follow back</div>
      </div>
      <div class="stat-card mint">
        <div class="stat-num green-text" id="stat-mutual">â€”</div>
        <div class="stat-label">Mutual follows</div>
      </div>
    </div>

    <div class="tabs">
      <button class="tab active" onclick="showTab('nonfollowers', this)">Not following you back</button>
      <button class="tab" onclick="showTab('notfollowing', this)">You don't follow back</button>
      <button class="tab" onclick="showTab('mutual', this)">Mutuals</button>
    </div>

    <input class="search-bar" type="text" id="search" placeholder="Search usernames..." oninput="filterList()">

    <div class="panel active" id="panel-nonfollowers">
      <div class="list-container" id="list-nonfollowers"></div>
    </div>
    <div class="panel" id="panel-notfollowing">
      <div class="list-container" id="list-notfollowing"></div>
    </div>
    <div class="panel" id="panel-mutual">
      <div class="list-container" id="list-mutual"></div>
    </div>
  </div>

  <div class="privacy-note"><span>ðŸ”’ 100% private</span> â€” everything runs in your browser. Your data never leaves your device.</div>
</div>

<script>
  let data = { followers: null, following: null };
  let results = { nonfollowers: [], notfollowing: [], mutual: [] };
  let activeTab = 'nonfollowers';

  function setupZone(zoneId, inputId, key, badgeId) {
    const zone = document.getElementById(zoneId);
    const input = document.getElementById(inputId);
    const badge = document.getElementById(badgeId);
    input.addEventListener('change', e => loadMultipleFiles(Array.from(e.target.files), key, badge, zone));
    zone.addEventListener('dragover', e => { e.preventDefault(); zone.classList.add('dragover'); });
    zone.addEventListener('dragleave', () => zone.classList.remove('dragover'));
    zone.addEventListener('drop', e => {
      e.preventDefault();
      zone.classList.remove('dragover');
      loadMultipleFiles(Array.from(e.dataTransfer.files), key, badge, zone);
    });
  }

  function readFileAsText(file) {
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.onload = e => resolve(e.target.result);
      reader.onerror = reject;
      reader.readAsText(file);
    });
  }

  async function loadMultipleFiles(files, key, badge, zone) {
    if (!files.length) return;
    try {
      badge.textContent = `Loading ${files.length} file(s)...`;
      badge.classList.remove('ok');
      const allUsernames = [];
      for (const file of files) {
        const content = await readFileAsText(file);
        const usernames = file.name.endsWith('.json')
          ? extractFromJSON(JSON.parse(content))
          : extractFromHTML(content);
        allUsernames.push(...usernames);
      }
      const unique = [...new Set(allUsernames)];
      if (unique.length === 0) {
        badge.textContent = 'âœ— No usernames found â€” wrong file?';
        badge.style.color = 'var(--red)';
        return;
      }
      data[key] = unique;
      badge.textContent = files.length > 1
        ? `âœ“ ${unique.length} accounts across ${files.length} files`
        : `âœ“ ${unique.length} accounts loaded`;
      badge.classList.add('ok');
      zone.classList.add('loaded');
      checkReady();
    } catch (err) {
      badge.textContent = 'âœ— Could not read files';
      badge.style.color = 'var(--red)';
    }
  }

  function extractFromHTML(html) {
    const usernames = [];
    const regex = /href="https?:\/\/(?:www\.)?instagram\.com\/(?:_u\/)?([^"\/\?#]+)/gi;
    let match;
    while ((match = regex.exec(html)) !== null) {
      const u = match[1].toLowerCase();
      if (!['p','reel','stories','explore','accounts','direct','tv','hashtag','_u'].includes(u)) {
        usernames.push(u);
      }
    }
    return [...new Set(usernames)];
  }

  function extractFromJSON(json) {
    const usernames = [];

    function extractFromItem(item) {
      // Try title field directly (new format)
      if (item.title) {
        usernames.push(item.title.toLowerCase());
        return;
      }
      // Try string_list_data array
      if (item.string_list_data) {
        item.string_list_data.forEach(u => {
          if (u.value) {
            usernames.push(u.value.toLowerCase());
          } else if (u.href) {
            // Extract username from href like https://www.instagram.com/_u/username
            const match = u.href.match(/instagram\.com\/(?:_u\/)?([^\/\?#]+)/i);
            if (match && match[1]) usernames.push(match[1].toLowerCase());
          }
        });
      }
    }

    if (Array.isArray(json)) {
      json.forEach(extractFromItem);
    } else if (json.relationships_following) {
      json.relationships_following.forEach(extractFromItem);
    } else if (json.relationships_followers) {
      json.relationships_followers.forEach(extractFromItem);
    } else if (json.string_list_data) {
      extractFromItem(json);
    }
    return [...new Set(usernames)];
  }

  function checkReady() {
    if (data.followers && data.following) document.getElementById('compare-btn').classList.add('ready');
  }

  function compare() {
    const followersSet = new Set(data.followers);
    const followingSet = new Set(data.following);
    results.nonfollowers = data.following.filter(u => !followersSet.has(u));
    results.notfollowing = data.followers.filter(u => !followingSet.has(u));
    results.mutual = data.following.filter(u => followersSet.has(u));

    document.getElementById('stat-nonfollowers').textContent = results.nonfollowers.length;
    document.getElementById('stat-notfollowing').textContent = results.notfollowing.length;
    document.getElementById('stat-mutual').textContent = results.mutual.length;

    renderList('nonfollowers');
    renderList('notfollowing');
    renderList('mutual');

    const resultsEl = document.getElementById('results');
    resultsEl.style.display = 'block';
    resultsEl.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }

  function renderList(type, filter = '') {
    const container = document.getElementById('list-' + type);
    const list = results[type].filter(u => u.includes(filter.toLowerCase()));
    if (list.length === 0) {
      container.innerHTML = `<div class="empty-state">${filter ? 'No matches found.' : 'Nothing here â€” all good!'}</div>`;
      return;
    }
    container.innerHTML = list.map((u, i) => `
      <div class="user-row" style="animation-delay:${Math.min(i * 0.02, 0.4)}s">
        <span class="username">@${u}</span>
        <a class="ig-link" href="https://instagram.com/${u}" target="_blank" rel="noopener">View â†—</a>
      </div>
    `).join('');
  }

  function showTab(tab, btn) {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
    btn.classList.add('active');
    document.getElementById('panel-' + tab).classList.add('active');
    activeTab = tab;
    document.getElementById('search').value = '';
    filterList();
  }

  function filterList() { renderList(activeTab, document.getElementById('search').value); }

  setupZone('zone-followers', 'file-followers', 'followers', 'badge-followers');
  setupZone('zone-following', 'file-following', 'following', 'badge-following');
</script>
</body>
</html>
